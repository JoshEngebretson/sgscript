
global ERRORS;
global tests_failed, tests_ran;

//
function section( x ){ print( "\n\t<< ", x, " >>\n" ); }
print( "\n\n-- NATIVE --\n" );
include_library( "native" );
include_library( "type" );
//

	section( "native_include_shared" );
testEqual( native_include_shared( "bin/sgstest.exe" ), true, "native_include_shared - sgscript_main call [1]" );
testEqual( imported_var, 1337, "native_include_shared - sgscript_main call [2]" );

	section( "native_import_cfunc" );
testEqual( typeof( native_import_cfunc( "bin/sgstest.exe", "sgscript_main" ) ), "cfunc", "native_import_cfunc - retrieval of entry point" );
ERRORS = ""; testEqual( native_import_cfunc( "bin/nosuchfile", "sgscript_main" ), null, "native_import_cfunc - invalid file name" ); testEqual( ERRORS, "[W:native_import_cfunc(): file not found]" );
ERRORS = ""; testEqual( native_import_cfunc( "bin/sgstest.exe", "nosuchfunc" ), null, "native_import_cfunc - invalid function name" ); testEqual( ERRORS, "[W:native_import_cfunc(): procedure not found]" );


//
print( "\n\nTesting finished!\nRan ", tests_ran, " tests of which ", tests_failed, " failed.\n" );
//
