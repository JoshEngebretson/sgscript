
global called = {};

obj = {a=1,b=2};
iface =
{
	__typeof = function(){ called.typeof = this; return "typeIFACE"; },
	__tobool = function(){ called.tobool = this; return true; },
	__toint = function(){ called.toint = this; return 8765; },
	__toreal = function(){ called.toreal = this; return 3.14159; },
	__tostring = function(){ called.tostring = this; return "IFACE"; },
	__toptr = function(){ called.toptr = this; return toptr(12345); },
};
class( obj, iface );

testEqual( metaobj_get(obj), iface, "metaobj - is set?" );

testEqual( typeof(obj), "typeIFACE", "metamethod - typeof - result" );
testEqual( @called.typeof, obj, "metamethod - typeof - correctly called" );

testEqual( tobool(obj), true, "metamethod - tobool - result" );
testEqual( @called.tobool, obj, "metamethod - tobool - correctly called" );

testEqual( toint(obj), 8765, "metamethod - toint - result" );
testEqual( @called.toint, obj, "metamethod - toint - correctly called" );

testEqual( toreal(obj), 3.14159, "metamethod - toreal - result" );
testEqual( @called.toreal, obj, "metamethod - toreal - correctly called" );

testEqual( tostring(obj), "IFACE", "metamethod - tostring - result" );
testEqual( @called.tostring, obj, "metamethod - tostring - correctly called" );

testEqual( toptr(obj), toptr(12345), "metamethod - toptr - result" );
testEqual( @called.toptr, obj, "metamethod - toptr - correctly called" );
